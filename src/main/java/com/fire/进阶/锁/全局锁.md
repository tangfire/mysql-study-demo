以下是 MySQL 全局锁的详细介绍，综合多篇技术文档与实践案例分析整理：

---

### 全局锁介绍

全局锁就是对整个数据库实例加锁，加锁后整个实例就处于只读状态，后续的DML的写语句，DDL语句，以及更新操作的事务提交语句都将被阻塞。

其典型的使用场景是做全库的逻辑备份，对所有的表进行锁定，从而获取一致性视图，保证数据的完整性。

### 一、全局锁的定义与作用
**全局锁**是 MySQL 中粒度最大的锁机制，通过 `FLUSH TABLES WITH READ LOCK`（FTWRL）命令，将整个数据库实例设为只读状态，阻止以下操作：
- **数据修改（DML）**：如 `INSERT`、`UPDATE`、`DELETE`。
- **表结构变更（DDL）**：如 `ALTER TABLE`、`DROP TABLE`。
- **事务提交**：涉及数据更新的未提交事务会被阻塞。

**核心作用**：  
保证全库逻辑备份时的**数据一致性**，避免备份过程中因数据修改导致备份结果不一致。例如，若备份中途有订单表数据更新但库存表未同步，恢复数据时会出现逻辑错误。

---

### 二、全局锁的使用场景
#### 1. **全库逻辑备份**
- **操作流程**：
  ```sql
  FLUSH TABLES WITH READ LOCK;  -- 加全局锁
  mysqldump -u root -p dbname > backup.sql;  -- 执行备份
  UNLOCK TABLES;  -- 释放锁
  ```
- **适用性**：
    - **MyISAM 引擎**：必须使用全局锁，因其不支持事务一致性视图。
    - **InnoDB 引擎**：可通过 `--single-transaction` 参数实现无锁备份（基于 MVCC 机制），但无法阻止 DDL 操作。

#### 2. **防止结构变更与数据写入**
在需要冻结数据库状态的场景下（如数据迁移或紧急修复），全局锁可确保操作期间数据完全静态。

---

### 三、全局锁的负面影响
#### 1. **业务停滞**
- **主库加锁**：备份期间所有写入操作阻塞，导致业务停摆。
- **从库加锁**：停止处理主库同步的 binlog，解锁后需追赶积压日志，造成主从延迟。

#### 2. **与只读模式的对比**
- **`readonly=true`**：
    - 同样使数据库只读，但可能干扰主从库判断逻辑。
    - **风险**：客户端异常断开后，数据库会保持只读状态，需手动恢复。
- **优先选择 FTWRL**：异常断开时自动释放锁，恢复写入能力。

---

### 四、全局锁的替代方案
#### 1. **InnoDB 事务快照(不加锁的一致性数据备份)**
使用 `mysqldump --single-transaction` 参数启动读事务，生成一致性视图。此方法：
- **优势**：不影响业务写入，避免锁表。
- **限制**：无法阻止 DDL 操作（如备份期间执行 `ALTER TABLE`）。

#### 2. **物理备份工具**
如 Percona XtraBackup，直接拷贝数据文件，需配合事务日志确保一致性。

---

### 五、最佳实践建议
1. **引擎选择**：优先使用 InnoDB，避免 MyISAM 强制全局锁的需求。
2. **备份时机**：在业务低峰期执行全库备份，减少影响。
3. **监控与优化**：
    - 观察 `SHOW PROCESSLIST` 判断锁等待情况。
    - 使用 `SHOW SLAVE STATUS` 监控主从延迟。

---

### 总结
| **维度**       | **说明**                                                                 |
|----------------|-------------------------------------------------------------------------|
| **核心功能**   | 冻结数据库写入，确保备份一致性                                          |
| **适用场景**   | MyISAM 全库备份、紧急数据修复                                           |
| **性能影响**   | 高（业务停摆或主从延迟）                                                |
| **替代方案**   | InnoDB 的 `--single-transaction`、物理备份工具                          |

全局锁是 MySQL 中“重量级”的锁机制，适用于严格一致性要求的场景，但需谨慎使用以避免业务中断。